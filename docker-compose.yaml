version: "3"
services:
  lazytainer:
    container_name: lazytainer
    build: .
    environment:
      - PORT=81 # TODO make this work with more than one port
      - LABEL=lazytainer # value of com.lazytainer.marker for other containers that lazytainer checks
      - TIMEOUT=30 # number of seconds to let container idle
    ports:
      - 81:81
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock:ro

  whoami2:
    container_name: whoami2
    image: containous/whoami
    command: --port 81
    network_mode: service:lazytainer
    depends_on: 
      - lazytainer
    # ports:
    # - 80:80
    labels:
      - "com.lazytainer.marker=lazytainer"